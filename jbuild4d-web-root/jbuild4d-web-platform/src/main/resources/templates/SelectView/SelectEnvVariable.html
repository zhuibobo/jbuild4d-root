<!DOCTYPE html><html lang="zh" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"><head><meta charset="UTF-8"><title>Title</title><th:block th:replace="Fragment/GeneralLib::GeneralLib"></th:block><th:block th:replace="Fragment/GeneralLib::IViewLib"></th:block><th:block th:replace="Fragment/GeneralLib::JQueryUILib"></th:block><th:block th:replace="Fragment/GeneralLib::EditTableLib"></th:block><th:block th:replace="Fragment/GeneralLib::ThemesLib"></th:block><th:block th:replace="Fragment/GeneralLib::ZTreeLib"></th:block></head><body><div id="appSelectView"><tabs :value="selectType" v-model="selectType"><tab-pane label="静态值" name="Const"><i-form :label-width="80" style="width:80%;margin:50px auto auto"><form-item label="静态值："><i-input v-model="selectValue"></i-input></form-item></i-form></tab-pane><tab-pane label="日期时间" name="DateTime"><ul id="datetimeZTreeUL" class="ztree"></ul></tab-pane><tab-pane label="API变量" name="ApiVar"><ul id="envVarZTreeUL" class="ztree"></ul></tab-pane><tab-pane label="序号编码" name="NumberCode"><ul id="numberCodeZTreeUL" class="ztree"></ul></tab-pane><tab-pane label="主键生成" name="IdCoder"><ul id="numberCodeZTreeUL1" class="ztree"></ul></tab-pane></tabs><div style="position:absolute;bottom:0;width:100%;text-align:center"><i-button type="primary" @click="selectEnvVar()">确 认</i-button><i-button style="margin-left:8px" type="primary" @click="clearEnvVar()">清 空</i-button><i-button style="margin-left:8px" @click="handleClose()">关 闭</i-button></div></div><script>var appSelectView=new Vue({el:"#appSelectView",data:{acInterface:{getSelectData:"/PlatForm/SelectView/SelectEnvVariable/GetSelectData"},selectType:"Const",selectValue:"",selectText:"",tree:{datetimeTreeObj:null,datetimeTreeSetting:{view:{dblClickExpand:!1,showLine:!0,fontCss:{color:"black","font-weight":"normal"}},data:{key:{name:"text"},simpleData:{enable:!0,idKey:"id",pIdKey:"parentId",rootPId:"-1"}},callback:{onClick:function(e,t,a){},onDblClick:function(e,t,a){},onAsyncSuccess:function(e,t,a,l){}}},datetimeTreeData:null,envVarTreeObj:null,envVarTreeSetting:{view:{dblClickExpand:!1,showLine:!0,fontCss:{color:"black","font-weight":"normal"}},data:{key:{name:"text"},simpleData:{enable:!0,idKey:"id",pIdKey:"parentId",rootPId:"-1"}},callback:{onClick:function(e,t,a){},onDblClick:function(e,t,a){},onAsyncSuccess:function(e,t,a,l){}}},envVarTreeData:null,numberCodeTreeObj:null,numberCodeTreeSetting:{},numberCodeTreeData:{}}},mounted:function(){this.loadData()},methods:{loadData:function(){var t=this;AjaxUtility.Post(this.acInterface.getSelectData,{},function(e){t.tree.datetimeTreeData=e.data.datetimeTreeData,t.tree.envVarTreeData=e.data.envVarTreeData,t.tree.datetimeTreeObj=$.fn.zTree.init($("#datetimeZTreeUL"),t.tree.datetimeTreeSetting,t.tree.datetimeTreeData),t.tree.datetimeTreeObj.expandAll(!0),t.tree.envVarTreeObj=$.fn.zTree.init($("#envVarZTreeUL"),t.tree.envVarTreeSetting,t.tree.envVarTreeData),t.tree.envVarTreeObj.expandAll(!0)},"json")},getSelectInstanceName:function(){return BaseUtility.GetUrlParaValue("instanceName")},selectEnvVar:function(){var e={};if("Const"==this.selectType)e.Type="Const",e.Value=this.selectValue,e.Text=this.selectValue;else if("DateTime"==this.selectType){0==(t=this.tree.datetimeTreeObj.getSelectedNodes()).length?DialogUtility.Alert(window,DialogUtility.DialogAlertId,{},"请选择一种时间类型！",null):(e.Type="DateTime",e.Value=t[0].value,e.Text=t[0].text)}else if("ApiVar"==this.selectType){var t;if(0==(t=this.tree.envVarTreeObj.getSelectedNodes()).length)DialogUtility.Alert(window,DialogUtility.DialogAlertId,{},"请选择一种API类型！",null);else{if(1==t[0].group)return void DialogUtility.Alert(window,DialogUtility.DialogAlertId,{},"不能选择分组！",null);e.Type="ApiVar",e.Value=t[0].value,e.Text=t[0].text}}else"NumberCode"==this.selectType&&(e.Type="NumberCode");window.OpenerWindowObj[this.getSelectInstanceName()].setSelectEnvVariableResultValue(e),this.handleClose()},clearEnvVar:function(){window.OpenerWindowObj[this.getSelectInstanceName()].setSelectEnvVariableResultValue(null),this.handleClose()},handleClose:function(){window.IsOpenForFrame?DialogUtility.Frame_CloseDialog(window):DialogUtility.CloseOpenIframeWindow(window,DialogUtility.DialogId)}}})</script></body></html>